這是一個完全全新的 Next.js 15 專案，使用 Tailwind + shadcn/ui
請直接幫我完成以下完整的功能，資料庫使用 Postgres + Prisma + Redis
你可以視情況，自由安裝任何其他套件

# PRD：自用短網址服務

## 1. 產品目標

* 將長網址縮短，方便分享。
* 追蹤每個短網址的基本數據（點擊數、來源等）。
* 提供單一管理員後台介面，需密碼登入，支援「記住我」功能。
* 自用為主，重點在 **快速開發、易於維護**，非商業化。

---

## 2. 使用者場景

* 我需要快速生成短網址，避免分享過長的連結。
* 我希望能看到這個連結被點了幾次、來自哪裡。
* 我需要一個簡單的登入機制保護後台。

---

## 3. 功能需求

### 3.1 短網址生成

* 自動產生隨機短碼（6–8 字元）。
* 可自訂短碼（避免衝突，需檢查重複）。

### 3.2 跳轉服務

* 使用 302 Redirect 轉址。
* 短碼失效或不存在時，顯示 404 頁面。

### 3.3 數據追蹤

* 每個短碼記錄：

  * 總點擊數。
  * 點擊時間（用於折線圖）。
  * Referrer（來源網站，若有）。
  * 裝置類型（Desktop / Mobile）。
  * 國家（根據 IP 粗略判斷）。

### 3.4 管理介面

* **短碼列表**：顯示原始網址、短碼、總點擊數、建立日期。
* **詳細頁**：顯示

  * 近 7 日 / 30 日點擊趨勢（折線圖）。
  * Top Referrers。
  * 國家分布。
* **匯出功能**：CSV 格式。

### 3.5 管理員登入（新增需求）

* **密碼驗證**

  * 密碼由環境變數（`ADMIN_PASSWORD`）設定。
  * 登入頁需輸入正確密碼才能進入管理後台。
* **記住我**

  * 勾選後，系統發長效 Cookie，有效期 365 天。
  * 未勾選則為 Session Cookie，瀏覽器關閉即失效。
* **安全性**

  * Cookie 設定：`HttpOnly + Secure + SameSite=Strict`。
* **登出**

  * 後台提供「登出」按鈕，刪除 Cookie。

---

## 4. 技術需求

### 4.1 架構

* **前端**：Next.js + Tailwind CSS + shadcn/ui。
* **後端**：Next.js API Routes（或 Edge Functions）。
* **資料庫**：

  * SQLite（單人自用，快速部署）。
  * 若日後需要可換成 Postgres。
* **事件處理**：

  * 點擊事件先寫入資料庫即可（不需分散式架構）。

### 4.2 資料模型

* **Links**

  * id, slug, target\_url, created\_at
* **Clicks**

  * id, link\_id, timestamp, referrer, user\_agent, country

---

## 5. UI / UX 指南

### 5.1 登入頁

* shadcn/ui 的 **Card + Input + Button + Checkbox**。
* 欄位：密碼輸入框、記住我（checkbox）、登入按鈕。

### 5.2 管理列表頁

* shadcn/ui 的 **Table + Button**。
* 顯示短碼、原始網址、總點擊數、建立日期。
* 提供「查看詳細」按鈕。

### 5.3 詳細頁

* shadcn/ui 的 **Card + Chart**（Recharts / Chart.js）。
* 折線圖：近 7 日 / 30 日點擊數。
* Top Referrers：以 Table 顯示。
* 國家分布：簡單圓餅圖。

---

## 6. 成功標準

* 短網址能在 5 秒內生成並可立即使用。
* 點擊短碼能正確跳轉，並記錄數據。
* 後台登入密碼功能正常，可「記住我」一年。
* 管理介面能正確顯示數據與圖表。

---

## 7. 風險與限制

* **濫用**：自用為主，不特別考慮釣魚風險。
* **隱私**：不存完整 IP，僅用於判斷國家。
* **效能**：單人使用，不需分散式架構。

---

## 8. 驗收條件

* 建立短碼後能馬上使用。
* 點擊數據能即時更新並在後台查看。
* 登入機制能正確判斷密碼、支援記住登入。
* 後台列表與詳細頁能正確顯示數據，匯出正常。
